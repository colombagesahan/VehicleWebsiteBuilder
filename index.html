<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VehicleWebsiteBuilder</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- NOTIFICATIONS & LOADERS -->
    <div id="loader" class="loader-overlay hidden">
        <div class="spinner"></div>
        <p id="loaderText">Processing...</p>
    </div>
    <div id="toastContainer" class="toast-container"></div>

    <!-- MODALS -->
    <div id="modalOverlay" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="close-modal" onclick="ui.closeModal()">&times;</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- AD & FACEBOOK MODALS (Preserved) -->
    <div id="adModal" class="modal-overlay hidden">
        <div class="modal-content ad-content">
            <button class="close-modal" onclick="document.getElementById('adModal').classList.add('hidden')">&times;</button>
            <div id="adContentArea"></div>
        </div>
    </div>

    <div id="fbModal" class="modal-overlay hidden">
        <div class="modal-content fb-content text-center">
            <button class="close-modal" onclick="document.getElementById('fbModal').classList.add('hidden')">&times;</button>
            <i class="fa-brands fa-facebook text-primary" style="font-size: 3rem; margin-bottom:1rem;"></i>
            <h3>Like us on Facebook!</h3>
            <div id="fbLinkArea" class="mt-4"></div>
        </div>
    </div>

    <!-- =======================================================
         PART 1: THE BUILDER PLATFORM (Dashboard)
    ======================================================== -->
    <div id="platformApp">
        <nav class="navbar">
            <div class="nav-brand">Vehicle<span>Builder</span></div>
            <div class="nav-links">
                <button id="btnLoginNav" class="btn btn-primary btn-sm">Login</button>
                <button id="btnLogoutNav" class="btn btn-outline btn-sm hidden">Logout</button>
            </div>
        </nav>

        <!-- Landing View -->
        <section id="viewLanding" class="view active">
            <div class="hero">
                <h1>Create Your Professional Vehicle Sales Website</h1>
                <p>Powerful, responsive, and easy to use. Start selling in minutes.</p>
                <button class="btn btn-primary btn-lg" onclick="ui.showView('viewAuth')">Get Started</button>
            </div>
            <div class="features">
                <div class="feat-card"><i class="fa-solid fa-mobile-screen"></i><h3>100% Mobile Ready</h3></div>
                <div class="feat-card"><i class="fa-solid fa-bolt"></i><h3>Fast Performance</h3></div>
                <div class="feat-card"><i class="fa-solid fa-wand-magic-sparkles"></i><h3>Auto Content</h3></div>
            </div>
        </section>

        <!-- Auth View -->
        <section id="viewAuth" class="view hidden">
            <div class="auth-container">
                <h2>Welcome Back</h2>
                <form id="authForm">
                    <input type="email" id="authEmail" placeholder="Email Address" required>
                    <input type="password" id="authPass" placeholder="Password" required>
                    <div class="btn-group">
                        <button type="button" id="btnLogin" class="btn btn-primary">Login</button>
                        <button type="button" id="btnSignup" class="btn btn-secondary">Create Account</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- User Dashboard -->
        <section id="viewDashboard" class="view hidden">
            <div class="dash-layout">
                <aside class="dash-sidebar">
                    <div class="user-info">
                        <div class="avatar-circle" id="dashAvatar"><i class="fa-solid fa-user"></i></div>
                        <span id="dashEmail">User</span>
                    </div>
                    <nav class="side-nav">
                        <button onclick="ui.switchTab('tabProfile')" class="nav-item active"><i class="fa-solid fa-id-card"></i> Profile</button>
                        <button onclick="ui.switchTab('tabAddVehicle')" class="nav-item"><i class="fa-solid fa-plus"></i> Add Vehicle</button>
                        <button onclick="ui.switchTab('tabMyVehicles')" class="nav-item"><i class="fa-solid fa-list"></i> My Vehicles</button>
                        <button onclick="ui.switchTab('tabWebsite')" class="nav-item"><i class="fa-solid fa-globe"></i> My Website</button>
                        <button onclick="ui.switchTab('tabConnect')" class="nav-item"><i class="fa-solid fa-users"></i> Connect</button>
                        <button onclick="ui.switchTab('tabAdmin')" id="navAdmin" class="nav-item hidden"><i class="fa-solid fa-lock"></i> Admin</button>
                    </nav>
                </aside>

                <main class="dash-content">
                    <!-- Tab: Profile (Preserved) -->
                    <div id="tabProfile" class="dash-tab active">
                        <h2>User Profile</h2>
                        <div class="card">
                            <p class="text-sm text-secondary mb-2">These details will appear on your "Contact Us" section.</p>
                            <div class="form-group">
                                <label>Profile Photo</label>
                                <input type="file" id="profPhoto" accept="image/*">
                            </div>
                            <div class="form-group">
                                <label>Phone Number *</label>
                                <input type="tel" id="profPhone">
                            </div>
                            <div class="form-group">
                                <label>WhatsApp Number *</label>
                                <input type="tel" id="profWhatsapp" placeholder="e.g. 94771234567">
                            </div>
                            <div class="form-group">
                                <label>Address *</label>
                                <textarea id="profAddress"></textarea>
                            </div>
                            <button id="saveProfile" class="btn btn-primary">Save Profile</button>
                        </div>
                    </div>

                    <!-- Tab: Add Vehicle (Preserved) -->
                    <div id="tabAddVehicle" class="dash-tab">
                        <h2>Add New Vehicle</h2>
                        <form id="formAddVehicle" class="card">
                            <div class="grid-2">
                                <select id="vCat" required></select>
                                <input type="text" id="vBrand" placeholder="Brand (e.g. Toyota)" required>
                                <input type="text" id="vModel" placeholder="Model (e.g. Premio)" required>
                                <input type="text" id="vTrim" placeholder="Trim">
                                <input type="number" id="vYear" placeholder="Year" required>
                                <input type="text" id="vCond" placeholder="Condition">
                                <select id="vTrans" required>
                                    <option value="Automatic">Automatic</option>
                                    <option value="Manual">Manual</option>
                                </select>
                                <select id="vFuel" required>
                                    <option value="Petrol">Petrol</option>
                                    <option value="Diesel">Diesel</option>
                                    <option value="Hybrid">Hybrid</option>
                                    <option value="Electric">Electric</option>
                                </select>
                                <input type="number" id="vPrice" placeholder="Price (Rs)" required>
                                <input type="number" id="vMileage" placeholder="Mileage (km)" required>
                            </div>
                            <div class="form-group">
                                <label>Description</label>
                                <textarea id="vDesc" maxlength="2500"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Images (Max 10)</label>
                                <input type="file" id="vPhotos" multiple accept="image/*">
                                <div id="vPreview" class="img-preview-grid"></div>
                            </div>
                            <button type="submit" class="btn btn-primary full-width">Upload & Publish</button>
                        </form>
                    </div>

                    <!-- Tab: My Vehicles (Preserved with Search) -->
                    <div id="tabMyVehicles" class="dash-tab">
                        <h2>My Inventory</h2>
                        <div class="filter-bar">
                            <input type="text" id="searchV" placeholder="Search by brand...">
                            <select id="sortV">
                                <option value="new">Newest First</option>
                                <option value="old">Oldest First</option>
                            </select>
                        </div>
                        <div id="myVehiclesList" class="vehicle-grid"></div>
                    </div>

                    <!-- Tab: Website Builder (IMPROVED & LOCKED) -->
                    <div id="tabWebsite" class="dash-tab">
                        <h2>Website Builder</h2>
                        
                        <!-- Lock Screen -->
                        <div id="websiteLockScreen" class="lock-overlay">
                            <div class="lock-box">
                                <i class="fa-solid fa-shop"></i>
                                <h3>Setup Your Dealership</h3>
                                <p>Enter your Vehicle Sale Name to unlock your professional website.</p>
                                <input type="text" id="initSaleName" placeholder="e.g. Dream Cars Lanka">
                                <button id="btnUnlockWebsite" class="btn btn-primary full-width">Create Website</button>
                            </div>
                        </div>

                        <!-- Unlocked Editor -->
                        <div id="websiteEditor" class="hidden">
                            <div class="info-banner">
                                <i class="fa-solid fa-link"></i>
                                Your URL: <a href="#" id="mySiteLink" target="_blank" class="font-bold">Generating...</a>
                            </div>

                            <div class="card">
                                <h3>1. Branding</h3>
                                <div class="form-group">
                                    <label>Vehicle Sale Name</label>
                                    <input type="text" id="webName">
                                </div>
                                <div class="grid-2">
                                    <div class="form-group">
                                        <label>Logo (Optional - We generate one if empty)</label>
                                        <input type="file" id="webLogo">
                                        <button id="rmLogo" class="btn btn-xs btn-outline hidden">Remove</button>
                                    </div>
                                    <div class="form-group">
                                        <label>Favicon</label>
                                        <input type="file" id="webFavicon">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Navigation Style</label>
                                    <select id="webNavStyle">
                                        <option value="1">Style 1: Centered (Logo Top)</option>
                                        <option value="2">Style 2: Left Aligned</option>
                                    </select>
                                </div>

                                <h3>2. Content (Auto-filled)</h3>
                                <div class="form-group">
                                    <label>Hero Title</label>
                                    <input type="text" id="webHeroTitle">
                                </div>
                                <div class="form-group">
                                    <label>Hero Subtitle</label>
                                    <input type="text" id="webHeroSub">
                                </div>
                                <div class="form-group">
                                    <label>About Us</label>
                                    <textarea id="webAbout" rows="5"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Why Choose Us (One point per line)</label>
                                    <textarea id="webWhy" rows="5"></textarea>
                                </div>
                                
                                <h3>3. Media & Social</h3>
                                <div class="form-group">
                                    <label>Gallery Images (Max 10)</label>
                                    <input type="file" id="webGallery" multiple>
                                </div>
                                <div class="form-group">
                                    <label>Facebook Page Link</label>
                                    <input type="text" id="webFb" placeholder="https://facebook.com/yourpage">
                                </div>

                                <button id="saveWebsite" class="btn btn-success mt-4">Save & Publish Changes</button>
                            </div>
                        </div>
                    </div>

                    <!-- Tab: Connect (Preserved) -->
                    <div id="tabConnect" class="dash-tab">
                        <h2>Connect with Sellers</h2>
                        <div id="sellersGrid" class="sellers-grid"></div>
                    </div>

                    <!-- Tab: Admin (Preserved) -->
                    <div id="tabAdmin" class="dash-tab">
                        <h2>Admin Panel</h2>
                        <div class="card">
                            <h3>Global Ad Manager</h3>
                            <input type="file" id="adminAdImg">
                            <button id="btnUploadAd" class="btn btn-primary">Upload Ad</button>
                        </div>
                    </div>
                </main>
            </div>
        </section>
    </div>

    <!-- =======================================================
         PART 2: THE GENERATED SUPER WEBSITE
    ======================================================== -->
    <div id="generatedSite" class="hidden">
        <!-- Navigation -->
        <header id="genHeader"></header>
        
        <!-- Hero Section -->
        <section id="genHero" class="gen-hero">
            <div class="hero-overlay"></div>
            <div class="hero-content scroll-anim">
                <h1 id="genHeroTitle"></h1>
                <p id="genHeroSub"></p>
                <a href="#genVehicles" class="hero-btn">Browse Inventory</a>
            </div>
        </section>

        <!-- All Vehicles (Smart Categories) -->
        <section id="genVehicles" class="gen-section">
            <h2 class="sec-title scroll-anim">Our Collection</h2>
            <!-- Categories will be injected here -->
            <div id="genCatFilter" class="filter-chips scroll-anim"></div>
            <div id="genVehicleGrid" class="vehicle-grid scroll-anim"></div>
        </section>

        <!-- About Us -->
        <section id="genAbout" class="gen-section bg-light">
            <div class="container-split">
                <div class="text-block scroll-anim">
                    <h2 class="sec-title-left">About Us</h2>
                    <div id="genAboutContent"></div>
                </div>
                <div class="image-block scroll-anim">
                    <img src="https://images.unsplash.com/photo-1560179707-f14e90ef3dab?auto=format&fit=crop&w=800&q=80" alt="Office">
                </div>
            </div>
        </section>

        <!-- Why Choose Us -->
        <section id="genWhy" class="gen-section bg-dark text-white">
            <h2 class="sec-title text-white scroll-anim">Why Choose Us</h2>
            <div id="genWhyGrid" class="features-grid scroll-anim"></div>
        </section>

        <!-- Gallery -->
        <section id="genGallery" class="gen-section">
            <h2 class="sec-title scroll-anim">Gallery</h2>
            <div id="genGalleryTrack" class="gallery-scroller scroll-anim"></div>
        </section>

        <!-- Happy Customers (Card Type) -->
        <section id="genReviews" class="gen-section bg-light">
            <h2 class="sec-title scroll-anim">Happy Customers</h2>
            <div class="reviews-grid scroll-anim">
                <div class="review-card">
                    <div class="stars">⭐⭐⭐⭐⭐</div>
                    <p>"Excellent service! The vehicle was exactly as described."</p>
                    <small>- Verified Buyer</small>
                </div>
                <div class="review-card">
                    <div class="stars">⭐⭐⭐⭐⭐</div>
                    <p>"Fair prices and transparent documentation. Highly recommended."</p>
                    <small>- Verified Buyer</small>
                </div>
                <div class="review-card">
                    <div class="stars">⭐⭐⭐⭐⭐</div>
                    <p>"Great experience dealing with this sale. Very professional."</p>
                    <small>- Verified Buyer</small>
                </div>
            </div>
        </section>

        <!-- Contact Us -->
        <section id="genContact" class="gen-section footer-section">
            <h2 class="sec-title text-white scroll-anim">Contact Us</h2>
            <div class="contact-layout scroll-anim">
                <div id="genContactInfo" class="contact-details"></div>
                <div id="genMap" class="map-box">
                     <iframe width="100%" height="100%" frameborder="0" style="border:0" src="https://maps.google.com/maps?q=Sri%20Lanka&t=&z=13&ie=UTF8&iwloc=&output=embed" allowfullscreen></iframe>
                </div>
            </div>
            <div id="genFooter" class="footer-bottom"></div>
        </section>

        <!-- Floating WhatsApp -->
        <a href="#" id="floatWhatsapp" class="float-wa hidden" target="_blank">
            <i class="fa-brands fa-whatsapp"></i>
        </a>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="script.js"></script>
</body>
</html>
